<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments :: head}">
    <meta charset="UTF-8">
    <title>Moodchart</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


</head>
<body>
<div th:replace="~{fragments :: logo}"></div>

<div><h1>Report</h1></div>
<div class="container">


    <div class="d-flex p-2 flex-row justify-content-around">
            <div id="first" style="width: 750px; height: 600px; margin: 0 auto"></div>
            <div id="second" style="width: 750px; height: 600px; margin: 0 auto"></div>
             <div > test</div>

    </div>


</div>

<div class="container">
<div>
    <canvas id="myChart"></canvas>
</div></div>

<script onload="fetchData()" src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<button onclick="fetchData()">fetch</button>

<script>
    //fetch function
    async function fetchData(){
        const url = 'http://localhost:8080/api/reports/user-report.json';
        const response = await fetch(url);
        //wait ultil the request has been completed
        const dataPoints = await response.json();
        console.log(dataPoints);

        return dataPoints;
    };

    fetchData().then(dataPoints => {
        const beh = dataPoints[0].reports[0].map(function(index){
            return index.behavior;
        })
        console.log(beh);
    });


    const ctx = document.getElementById('myChart');

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
            datasets: [{
                label: '# of Votes',
                data: [12, 19, 3, 5, 2, 3],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
</script>


<script th:inline="javascript">
    Highcharts.chart('first', {

        title: {
            text: 'Emotions'
        },

        subtitle: {
            text: 'How to you classify the patient\'s emotions throughout the day?'
        },

        // colors: ['red', 'orange', 'green', 'blue', 'purple', 'brown'],

        yAxis: {
            title: {
                text: 'Range'
            }
        },

        xAxis: {
            type: 'datetime',
            categories: [[${anger.keySet()  }]],
            tickInterval: 24 * 3600 * 1000,
            labels: {
                format: '{value:%d-%m}',
                rotation: 45,
                align: 'left'
            },


            accessibility: {
                rangeDescription: 'Range: 2010 to 2020'
            }

        },

        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle'
        },


        plotOptions: {
            series: {
                type: 'datetime',

                label: {
                    // connectorAllowed: false,
                    format: '{value:%d-%m}'
                },

                pointStart: Date.UTC([[${fristDate}]]),
                format: '{value:%d-%m}',
                pointInterval: 24 * 3600 * 1000 // one day
            }
        },

        series: [{
            name: 'Anger',
            data: [[${anger.values()}]],
        }, {
            name: 'Trust',
            data: [[${trust.values()}]]
        }, {
            name: 'Surprise',
            data: [[${surprise.values()}]]
        }, {
            name: 'Anticipation',
            data: [[${anticipation.values()}]]
        }, {
            name: 'Disgust',
            data: [[${disgust.values()}]]
        }, {
            name: 'Fear',
            data: [[${fear.values()}]]
        }, {
            name: 'Sadness',
            data: [[${sadness.values()}]]
        }, {
            name: 'Joy',
            data: [[${joy.values()}]]
        }],

        responsive: {
            rules: [{
                condition: {
                    maxWidth: 1200,
                },
                chartOptions: {
                    legend: {
                        layout: 'horizontal',
                        align: 'center',
                        verticalAlign: 'bottom'
                    }
                }
            }]
        }

    });

</script>

<script th:inline="javascript">
    Highcharts.chart('second', {

        title: {
            text: 'Symptoms'
        },

        subtitle: {
            text: 'Did the patient have any of those symptoms throughout the day?\n'
        },

        colors: ['red', 'orange', 'green', 'blue', 'purple', 'brown'],

        yAxis: {
            title: {
                text: 'Range'
            }
        },

        xAxis: {
            type: 'datetime',
            categories: [[${anger.keySet()}]],
            tickInterval: 24 * 3600 * 1000,

            labels: {
                format: '{value:%d-%m}',
                rotation: 45,
                align: 'left'
            },


            accessibility: {
                rangeDescription: 'Range: 2010 to 2020'
            }

        },

        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle'
        },


        plotOptions: {
            series: {
                type: 'datetime',

                label: {
                    // connectorAllowed: false,
                    format: '{value:%d-%m}'
                },

                pointStart: Date.UTC([[${fristDate}]]),
                format: '{value:%d-%m}',
                pointInterval: 24 * 3600 * 1000, // one day
                relativeXValue: true

            }
        },

        series: [{
            name: 'Anger',
            data: [[${anger.values()}]],
        }, {
            name: 'Trust',
            data: [[${trust.values()}]]
        }, {
            name: 'Surprise',
            data: [[${surprise.values()}]]
        }, {
            name: 'Anticipation',
            data: [[${anticipation.values()}]]
        }, {
            name: 'Disgust',
            data: [[${disgust.values()}]]
        }],

        responsive: {
            rules: [{
                condition: {
                    maxWidth: 1200,
                },
                chartOptions: {
                    legend: {
                        layout: 'horizontal',
                        align: 'center',
                        verticalAlign: 'bottom'
                    }
                }
            }]
        }

    });

</script>

</body>
</html>

<script
        src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<!-- Latest compiled and minified JavaScript -->
<script
        src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>